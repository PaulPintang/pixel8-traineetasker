import{N as I,h as K,r as B,Z as V,m as W,L as Y,z as ee,o as n,p as e,T as f,q as h,G as u,O as te,P as c,A as ne,F as p,Q as U,U as ae,B as _,C as le,E as se,s as ie,t as oe,x as ce}from"./index-34c9220a.js";import{l as re,H as de,I as he,P as me}from"./lodash-fce6eaa4.js";import{I as N}from"./IconClock-201cdd29.js";import{I as ge}from"./IconDots-0fd6a487.js";const T={morning:{in:8,out:12},afternoon:{in:13,out:17}},ue=l=>{var b,m,i;const o=new Date().getHours(),s=l==null?void 0:l.find(g=>g.date===I().date),r=!s&&T.morning.in===o?!0:((b=s==null?void 0:s.afternoon)==null?void 0:b.in)===""&&T.afternoon.in===o,x=((m=s==null?void 0:s.morning)==null?void 0:m.out)===""&&T.morning.out===o?!0:((i=s==null?void 0:s.afternoon)==null?void 0:i.out)===""&&T.afternoon.out===o;return{isTimeIn:r,isTimeOut:x,today:s}},pe=()=>{const l=new Date().getHours();let a=null;return l>=0&&l<12?a="morning":l>=12&&l<18&&(a="afternoon"),a},fe=({profile:l})=>{var C;const{user:a}=K(t=>t.auth),[o,s]=B.useState(1),[r,x]=B.useState(""),[b,{isLoading:m}]=V(),{data:i}=W(void 0,{skip:(a==null?void 0:a.role)!=="trainee"}),{data:g}=Y(l?l==null?void 0:l.course:i==null?void 0:i.course),v=g==null?void 0:g.find(t=>t._id===(l==null?void 0:l._id)),k=(a==null?void 0:a.role)==="trainee"?i==null?void 0:i.dtr:v==null?void 0:v.dtr,y=k==null?void 0:k.filter(t=>{var d;return(d=t.date)==null?void 0:d.toLowerCase().includes(r.toLowerCase())}),z=re.chunk(y,10),R=pe(),D=async()=>{await b({rooms:[a==null?void 0:a.course]}),ce(` ${R==="morning"?"Time in":"Time out"} at exactly ${I().time}`,"success")};ee("DailyTimeRecords");const X=(C=z[o-1])==null?void 0:C.slice().sort((t,d)=>d.date.localeCompare(t.date)).map((t,d)=>{var S,A,L,P,H,M,O,j,E,G,Q,F,$,q;return n("tr",{className:"border-none ",children:[e("td",{className:" md:table-cell lg:table-cell pl-3",children:e(f,{children:e(de,{highlightColor:"cyan",highlight:r,children:I().date===t.date?"Today":t.date})})}),e("td",{className:"hidden md:table-cell lg:table-cell",children:e(h,{children:n(u,{spacing:8,children:[e(N,{size:16,className:"text-yellow-400"}),e("span",{children:(S=t.morning)==null?void 0:S.in})," -"," ",e("span",{children:(A=t.morning)==null?void 0:A.out})]})})}),e("td",{className:"hidden md:table-cell lg:table-cell",children:e(h,{children:n(u,{spacing:8,children:[e(N,{size:16,className:"text-violet-400"}),e("span",{children:(L=t.afternoon)==null?void 0:L.in})," -"," ",e("span",{children:(P=t.afternoon)==null?void 0:P.out})]})})}),e("td",{className:"py-2  md:table-cell lg:table-cell ",children:t.status==="recorded"?n(h,{align:"center",gap:6,className:"bg-gray-50 px-2 py-1 rounded w-max",children:[e("div",{className:"w-2 h-2 bg-green-300"}),e(f,{fw:"bold",className:"text-[10px] text-green-300 uppercase",children:t.status})]}):n(h,{align:"center",gap:6,className:"bg-gray-50 px-2 py-1 rounded w-max",children:[e(te,{processing:!0,size:7,radius:0,color:((H=t.morning)==null?void 0:H.in)!==""&&((M=t.morning)==null?void 0:M.out)===""?"yellow":"indigo",className:"opacity-70",ml:2,mr:5,mb:1,children:e("span",{})}),e(f,{fw:"bold",className:`text-[10px] uppercase ${((O=t.morning)==null?void 0:O.in)!==""&&((j=t.morning)==null?void 0:j.out)===""?"text-yellow-300":"text-indigo-300"}`,children:t.status})]})}),e("td",{className:"py-2 table-cell  md:hidden lg:hidden ",children:n(c,{shadow:"md",transitionProps:{transition:"rotate-right",duration:150},withArrow:!0,children:[e(c.Target,{children:e(ne,{variant:"white",color:"cyan",children:e(ge,{size:19})})}),n(c.Dropdown,{children:[((E=t.morning)==null?void 0:E.in)!==""&&n(p,{children:[e(c.Label,{children:"Morning"}),e(c.Item,{p:0,className:"bg-white hover:bg-white",children:e(U,{px:10,pb:5,spacing:1,children:n(u,{spacing:8,className:"text-xs",children:[e(N,{size:16,className:"text-yellow-400"}),e("span",{children:(G=t.morning)==null?void 0:G.in})," -"," ",e("span",{children:(Q=t.morning)==null?void 0:Q.out})]})})}),e(c.Divider,{})]}),((F=t.afternoon)==null?void 0:F.in)!==""&&n(p,{children:[e(c.Label,{children:"Afternoon"}),e(c.Item,{p:0,className:"bg-white hover:bg-white",children:e(U,{px:10,pb:5,spacing:1,children:n(u,{spacing:8,className:"text-xs",children:[e(N,{size:16,className:"text-violet-400"}),e("span",{children:($=t.afternoon)==null?void 0:$.in})," -"," ",e("span",{children:(q=t.afternoon)==null?void 0:q.out})]})})})]})]})]})})]},d)}),{isTimeIn:Z,isTimeOut:J,today:w}=ue(i==null?void 0:i.dtr);return n("div",{className:"pb-3",children:[n(h,{justify:"space-between",align:"center",pb:6,children:[e(ae,{}),(a==null?void 0:a.role)==="trainee"&&e(p,{children:!w||(w==null?void 0:w.status)!=="recorded"?n(p,{children:[Z?e(_,{color:"yellow",size:"xs",onClick:D,loading:m,children:"Time in"}):"",J?e(_,{color:"indigo",size:"xs",onClick:D,loading:m,children:"Time out"}):""]}):""})]}),n(le,{className:"bg-opacity-60 rounded-md shadow-md h-[calc(100vh-160px)] ",children:[e("div",{className:"h-[95%]",children:n("table",{className:"border-collapse border-none w-full",children:[e("thead",{children:n("tr",{children:[e("th",{scope:"col",className:" md:px-3 lg:px-3 pl-3 py-3 text-left text-[12px] font-[600] text-gray-400 tracking-wider  bg-gray-100 shadow-sm rounded-tl-md",children:"Date"}),e("th",{scope:"col",className:"hidden  md:table-cell lg:table-cell rounded-tl-md md:rounded-none lg:rounded-none py-3  md:pr-3 lg:pr-3 text-left text-[12px] font-[600] text-gray-400 tracking-wider  bg-gray-100 shadow-sm",children:"Morning"}),e("th",{scope:"col",className:"hidden md:table-cell lg:table-cell py-3 text-left text-[12px] font-[600] text-gray-400 tracking-wider bg-gray-100 shadow-sm rounded-tr-md lg:rounded-none",children:"Afternoon"}),e("th",{scope:"col",className:"  md:table-cell lg:table-cell  py-3 text-left text-[11px] font-[600] text-gray-400   tracking-wider  bg-gray-100 shadow-sm lg:rounded-tr-md rounded-none",children:"Status"}),e("th",{scope:"col",className:"  md:hidden lg:hidden table-cell  py-3 text-left text-[11px] font-[600] text-gray-400   tracking-wider  bg-gray-100 shadow-sm rounded-tr-md"})]})}),(y==null?void 0:y.length)===0?e(p,{children:e(se,{text:"No records found"})}):e("tbody",{className:"text-sm text-gray-600",children:X})]})}),n(h,{justify:"space-between",children:[e(ie,{rightSection:r?e(oe,{onClick:()=>x(""),size:14,className:"hover:cursor-pointer text-gray-500 hover:text-gray-800 transition-all"}):e(he,{size:14,className:"text-gray-500"}),size:"xs",placeholder:"Search date, ex. May 9",value:r,onChange:t=>x(t.currentTarget.value)}),n(u,{children:[n(f,{c:"dimmed",fz:"xs",className:"hidden lg:flex md:flex",children:["Page ",o," of ",z.length]}),e(me,{total:z.length,value:o,onChange:s,size:"xs",color:"teal"})]})]})]})]})};export{fe as default};
