import{K as k,h as Y,r as J,W as V,k as Z,J as ee,X as te,i as ne,x as ae,m as a,n as e,T as f,o as h,G as u,L as c,A as le,F as p,N as R,O as se,B as X,C as ie,E as oe,p as ce,q as re,Y as de,v as he}from"./index-ef5c4769.js";import{l as me,H as ge,I as ue,P as pe}from"./lodash-2ab651e2.js";import{a as N,I as xe}from"./IconClock-6cf31baf.js";import{I as be}from"./IconDots-fd98005d.js";const T={morning:{in:8,out:12},afternoon:{in:13,out:17}},ye=l=>{var m,b,g;const n=new Date,o=n.getHours(),s=l==null?void 0:l.find(i=>i.date===k(n.toISOString()).date),r=!s&&T.morning.in===o?!0:((m=s==null?void 0:s.afternoon)==null?void 0:m.in)===""&&T.afternoon.in===o,x=((b=s==null?void 0:s.morning)==null?void 0:b.out)===""&&T.morning.out===o?!0:((g=s==null?void 0:s.afternoon)==null?void 0:g.out)===""&&T.afternoon.out===o;return{isTimeIn:r,isTimeOut:x,today:s}},we=()=>{const l=new Date().getHours();let n=null;return l>=0&&l<12?n="morning":l>=12&&l<18&&(n="afternoon"),n},ve=({profile:l})=>{var C;const{user:n}=Y(t=>t.auth),[o,s]=J.useState(1),[r,x]=J.useState(""),m=new Date,[b,{isLoading:g}]=V(),{data:i}=Z(void 0,{skip:(n==null?void 0:n.role)!=="trainee"}),{data:v}=ee(l?l==null?void 0:l.course:i==null?void 0:i.course);te();const I=v==null?void 0:v.find(t=>t._id===(l==null?void 0:l._id));ne();const S=(n==null?void 0:n.role)==="trainee"?i==null?void 0:i.dtr:I==null?void 0:I.dtr,y=S==null?void 0:S.filter(t=>{var d;return(d=t.date)==null?void 0:d.toLowerCase().includes(r.toLowerCase())}),D=me.chunk(y,10),_=we(),z=async()=>{de(n==null?void 0:n.course,n==null?void 0:n.role),await b({rooms:[n==null?void 0:n.course]}),he(` ${_==="morning"?"Time in":"Time out"} at exactly ${k(m.toISOString()).time}`,"success")};ae("DailyTimeRecords");const K=(C=D[o-1])==null?void 0:C.slice().sort((t,d)=>d.date.localeCompare(t.date)).map((t,d)=>{var A,L,O,H,M,P,G,j,E,Q,F,$,q,B;return a("tr",{className:"border-none ",children:[e("td",{className:" md:table-cell lg:table-cell pl-3",children:e(f,{children:e(ge,{highlightColor:"cyan",highlight:r,children:k(t.date).date===m.toDateString()?"Today":k(t.date).date})})}),e("td",{className:"hidden md:table-cell lg:table-cell",children:e(h,{children:a(u,{spacing:8,children:[e(N,{size:16,className:"text-yellow-400"}),e("span",{children:(A=t.morning)==null?void 0:A.in})," -"," ",e("span",{children:(L=t.morning)==null?void 0:L.out})]})})}),e("td",{className:"hidden md:table-cell lg:table-cell",children:e(h,{children:a(u,{spacing:8,children:[e(N,{size:16,className:"text-violet-400"}),e("span",{children:(O=t.afternoon)==null?void 0:O.in})," -"," ",e("span",{children:(H=t.afternoon)==null?void 0:H.out})]})})}),e("td",{className:"py-2  md:table-cell lg:table-cell ",children:t.status==="recorded"?a(h,{align:"center",gap:6,className:"bg-gray-50 px-2 py-1 rounded w-max",children:[e("div",{className:"w-2 h-2 bg-green-300"}),e(f,{fw:"bold",className:"text-[10px] text-green-300 uppercase",children:t.status})]}):a(h,{align:"center",gap:6,className:"bg-gray-50 px-2 py-1 rounded w-max",children:[e(xe,{processing:!0,size:7,radius:0,color:((M=t.morning)==null?void 0:M.in)!==""&&((P=t.morning)==null?void 0:P.out)===""?"yellow":"indigo",className:"opacity-70",ml:2,mr:5,mb:1,children:e("span",{})}),e(f,{fw:"bold",className:`text-[10px] uppercase ${((G=t.morning)==null?void 0:G.in)!==""&&((j=t.morning)==null?void 0:j.out)===""?"text-yellow-300":"text-indigo-300"}`,children:t.status})]})}),e("td",{className:"py-2 table-cell  md:hidden lg:hidden ",children:a(c,{shadow:"md",transitionProps:{transition:"rotate-right",duration:150},withArrow:!0,children:[e(c.Target,{children:e(le,{variant:"white",color:"cyan",children:e(be,{size:19})})}),a(c.Dropdown,{children:[((E=t.morning)==null?void 0:E.in)!==""&&a(p,{children:[e(c.Label,{children:"Morning"}),e(c.Item,{p:0,className:"bg-white hover:bg-white",children:e(R,{px:10,pb:5,spacing:1,children:a(u,{spacing:8,className:"text-xs",children:[e(N,{size:16,className:"text-yellow-400"}),e("span",{children:(Q=t.morning)==null?void 0:Q.in})," -"," ",e("span",{children:(F=t.morning)==null?void 0:F.out})]})})}),e(c.Divider,{})]}),(($=t.afternoon)==null?void 0:$.in)!==""&&a(p,{children:[e(c.Label,{children:"Afternoon"}),e(c.Item,{p:0,className:"bg-white hover:bg-white",children:e(R,{px:10,pb:5,spacing:1,children:a(u,{spacing:8,className:"text-xs",children:[e(N,{size:16,className:"text-violet-400"}),e("span",{children:(q=t.afternoon)==null?void 0:q.in})," -"," ",e("span",{children:(B=t.afternoon)==null?void 0:B.out})]})})})]})]})]})})]},d)}),{isTimeIn:U,isTimeOut:W,today:w}=ye(i==null?void 0:i.dtr);return a("div",{className:"pb-3",children:[a(h,{justify:"space-between",align:"center",pb:6,children:[e(se,{}),(n==null?void 0:n.role)==="trainee"&&e(p,{children:!w||(w==null?void 0:w.status)!=="recorded"?a(p,{children:[U?e(X,{color:"yellow",size:"xs",onClick:z,loading:g,children:"Time in"}):"",W?e(X,{color:"indigo",size:"xs",onClick:z,loading:g,children:"Time out"}):""]}):""})]}),a(ie,{className:"bg-opacity-60 rounded-md shadow-md h-[calc(100vh-160px)] ",children:[e("div",{className:"h-[95%]",children:a("table",{className:"border-collapse border-none w-full",children:[e("thead",{children:a("tr",{children:[e("th",{scope:"col",className:" md:px-3 lg:px-3 pl-3 py-3 text-left text-[12px] font-[600] text-gray-400 tracking-wider  bg-gray-100 shadow-sm rounded-tl-md",children:"Date"}),e("th",{scope:"col",className:"hidden  md:table-cell lg:table-cell rounded-tl-md md:rounded-none lg:rounded-none py-3  md:pr-3 lg:pr-3 text-left text-[12px] font-[600] text-gray-400 tracking-wider  bg-gray-100 shadow-sm",children:"Morning"}),e("th",{scope:"col",className:"hidden md:table-cell lg:table-cell py-3 text-left text-[12px] font-[600] text-gray-400 tracking-wider bg-gray-100 shadow-sm rounded-tr-md lg:rounded-none",children:"Afternoon"}),e("th",{scope:"col",className:"  md:table-cell lg:table-cell  py-3 text-left text-[11px] font-[600] text-gray-400   tracking-wider  bg-gray-100 shadow-sm lg:rounded-tr-md rounded-none",children:"Status"}),e("th",{scope:"col",className:"  md:hidden lg:hidden table-cell  py-3 text-left text-[11px] font-[600] text-gray-400   tracking-wider  bg-gray-100 shadow-sm rounded-tr-md"})]})}),(y==null?void 0:y.length)===0?e(p,{children:e(oe,{text:"No records found"})}):e("tbody",{className:"text-sm text-gray-600",children:K})]})}),a(h,{justify:"space-between",children:[e(ce,{rightSection:r?e(re,{onClick:()=>x(""),size:14,className:"hover:cursor-pointer text-gray-500 hover:text-gray-800 transition-all"}):e(ue,{size:14,className:"text-gray-500"}),size:"xs",placeholder:"Search date, ex. May 9",value:r,onChange:t=>x(t.currentTarget.value)}),a(u,{children:[a(f,{c:"dimmed",fz:"xs",className:"hidden lg:flex md:flex",children:["Page ",o," of ",D.length]}),e(pe,{total:D.length,value:o,onChange:s,size:"xs",color:"teal"})]})]})]})]})};export{ve as default};
