import{i as W,N as X,l as Y,D as Z,O as $,j as ee,r as te,E as b,v as ne,m as n,n as e,T as S,o as f,G as w,H as c,A as ae,F as h,J as Q,K as le,B,C as se}from"./index-0f9aaaa8.js";import{l as ie,P as oe}from"./lodash-20c46a18.js";import{I as y}from"./IconClock-3e352936.js";import{I as ce}from"./IconDots-1ab4d11e.js";const re=()=>{const i=new Date().getHours();let a=null;return i>=0&&i<12?a="morning":i>=12&&i<18&&(a="afternoon"),a},pe=({profile:i})=>{var A,P,C,O,j;const{user:a}=W(t=>t.auth),[R,{isLoading:v}]=X(),{data:o,refetch:_}=Y(),{data:N}=Z(i==null?void 0:i.course,{skip:(a==null?void 0:a.role)==="trainee"}),[J,de]=$(),T=N==null?void 0:N.find(t=>t._id===(i==null?void 0:i._id)),{data:r}=ee(),m=new Date,g=m.getHours();re();const u={morning:{in:8,out:12},afternoon:{in:13,out:17}},[k,K]=te.useState(1),z=async()=>{var d;await R();const t=(d=o==null?void 0:o.timesheet)==null?void 0:d.some(s=>s.date===b(m.toISOString()).date),I=r==null?void 0:r.some(s=>s.status==="inprogress");if(!t&&I){const s=r==null?void 0:r.filter(x=>x.status==="inprogress"),p={task:s==null?void 0:s[0].taskname,ticket:s==null?void 0:s[0].ticketno};await J({sheet:p,rooms:[a==null?void 0:a.course]})}_()},D=ie.chunk((a==null?void 0:a.role)==="trainee"?o==null?void 0:o.dtr:T==null?void 0:T.dtr,10),l=(A=o==null?void 0:o.dtr)==null?void 0:A.find(t=>t.date===b(m.toISOString()).date);ne("DailyTimeRecords");const U=(P=D[k-1])==null?void 0:P.map((t,I)=>{var d,s,p,x,G,H,M,E,L,F;return n("tr",{className:"border-none ",children:[e("td",{className:" md:table-cell lg:table-cell pl-3",children:e(S,{children:b(t.date).date===m.toDateString()?"Today":b(t.date).date})}),e("td",{className:"hidden md:table-cell lg:table-cell",children:e(f,{children:n(w,{spacing:8,children:[e(y,{size:16,className:"text-yellow-400"}),e("span",{children:(d=t.morning)==null?void 0:d.in})," -"," ",e("span",{children:(s=t.morning)==null?void 0:s.out})]})})}),e("td",{className:"hidden md:table-cell lg:table-cell",children:e(f,{children:n(w,{spacing:8,children:[e(y,{size:16,className:"text-violet-400"}),e("span",{children:(p=t.afternoon)==null?void 0:p.in})," -"," ",e("span",{children:(x=t.afternoon)==null?void 0:x.out})]})})}),e("td",{className:"py-2  md:table-cell lg:table-cell ",children:e(S,{fw:"bold",fz:"xs",children:t.status})}),e("td",{className:"py-2 table-cell  md:hidden lg:hidden ",children:n(c,{shadow:"md",transitionProps:{transition:"rotate-right",duration:150},withArrow:!0,children:[e(c.Target,{children:e(ae,{variant:"white",color:"cyan",children:e(ce,{size:19})})}),n(c.Dropdown,{children:[((G=t.morning)==null?void 0:G.in)!==""&&n(h,{children:[e(c.Label,{children:"Morning"}),e(c.Item,{p:0,className:"bg-white hover:bg-white",children:e(Q,{px:10,pb:5,spacing:1,children:n(w,{spacing:8,className:"text-xs",children:[e(y,{size:16,className:"text-yellow-400"}),e("span",{children:(H=t.morning)==null?void 0:H.in})," -"," ",e("span",{children:(M=t.morning)==null?void 0:M.out})]})})}),e(c.Divider,{})]}),((E=t.afternoon)==null?void 0:E.in)!==""&&n(h,{children:[e(c.Label,{children:"Afternoon"}),e(c.Item,{p:0,className:"bg-white hover:bg-white",children:e(Q,{px:10,pb:5,spacing:1,children:n(w,{spacing:8,className:"text-xs",children:[e(y,{size:16,className:"text-violet-400"}),e("span",{children:(L=t.afternoon)==null?void 0:L.in})," -"," ",e("span",{children:(F=t.afternoon)==null?void 0:F.out})]})})})]})]})]})})]},I)}),q=!l&&u.morning.in===g?!0:((C=l==null?void 0:l.afternoon)==null?void 0:C.in)===""&&u.afternoon.in===g,V=((O=l==null?void 0:l.morning)==null?void 0:O.out)===""&&u.morning.out===g?!0:((j=l==null?void 0:l.afternoon)==null?void 0:j.out)===""&&u.afternoon.out===g;return n(h,{children:[n(f,{justify:"space-between",align:"center",pb:6,children:[e(le,{}),(a==null?void 0:a.role)==="trainee"&&e(h,{children:!l||(l==null?void 0:l.status)!=="recorded"?n(h,{children:[q?e(B,{color:"yellow",size:"xs",onClick:z,loading:v,children:"Time in"}):"",V?e(B,{color:"indigo",size:"xs",onClick:z,loading:v,children:"Time out"}):""]}):""})]}),n(se,{className:"bg-opacity-60 rounded-md shadow-md h-[calc(100vh-190px)]",children:[e("div",{className:"h-[96%]",children:n("table",{className:"border-collapse border-none w-full",children:[e("thead",{children:n("tr",{children:[e("th",{scope:"col",className:" md:px-3 lg:px-3 pl-3 py-3 text-left text-[12px] font-[600] text-gray-400 tracking-wider  bg-gray-100 shadow-sm rounded-tl-md",children:"Date"}),e("th",{scope:"col",className:"hidden  md:table-cell lg:table-cell rounded-tl-md md:rounded-none lg:rounded-none py-3  md:pr-3 lg:pr-3 text-left text-[12px] font-[600] text-gray-400 tracking-wider  bg-gray-100 shadow-sm",children:"Morning"}),e("th",{scope:"col",className:"hidden md:table-cell lg:table-cell py-3 text-left text-[12px] font-[600] text-gray-400 tracking-wider bg-gray-100 shadow-sm rounded-tr-md lg:rounded-none",children:"Afternoon"}),e("th",{scope:"col",className:"  md:table-cell lg:table-cell  py-3 text-left text-[11px] font-[600] text-gray-400   tracking-wider  bg-gray-100 shadow-sm lg:rounded-tr-md rounded-none",children:"Status"}),e("th",{scope:"col",className:"  md:hidden lg:hidden table-cell  py-3 text-left text-[11px] font-[600] text-gray-400   tracking-wider  bg-gray-100 shadow-sm rounded-tr-md"})]})}),e("tbody",{className:"text-sm text-gray-600",children:U})]})}),n(f,{justify:"space-between",children:[n(S,{c:"dimmed",fz:"xs",children:["Page ",k," of ",D.length]}),e(oe,{total:D.length,value:k,onChange:K,size:"xs",color:"teal",withEdges:!0})]})]})]})};export{pe as default};
