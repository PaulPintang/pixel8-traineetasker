import{K as z,h as X,r as B,W as V,k as Y,J as Z,x as ee,m as n,n as e,T as f,o as h,G as u,L as c,A as te,F as p,N as _,O as ne,B as J,C as ae,E as le,p as se,q as ie,v as oe}from"./index-a5ac19d2.js";import{l as ce,H as re,I as de,P as he}from"./lodash-96b36927.js";import{a as N,I as me}from"./IconClock-1ceabe6e.js";import{I as ge}from"./IconDots-b03f8873.js";const T={morning:{in:8,out:12},afternoon:{in:13,out:17}},ue=l=>{var b,m,i;const o=new Date().getHours(),s=l==null?void 0:l.find(g=>g.date===z().date),r=!s&&T.morning.in===o?!0:((b=s==null?void 0:s.afternoon)==null?void 0:b.in)===""&&T.afternoon.in===o,x=((m=s==null?void 0:s.morning)==null?void 0:m.out)===""&&T.morning.out===o?!0:((i=s==null?void 0:s.afternoon)==null?void 0:i.out)===""&&T.afternoon.out===o;return{isTimeIn:r,isTimeOut:x,today:s}},pe=()=>{const l=new Date().getHours();let a=null;return l>=0&&l<12?a="morning":l>=12&&l<18&&(a="afternoon"),a},fe=({profile:l})=>{var C;const{user:a}=X(t=>t.auth),[o,s]=B.useState(1),[r,x]=B.useState(""),[b,{isLoading:m}]=V(),{data:i}=Y(void 0,{skip:(a==null?void 0:a.role)!=="trainee"}),{data:g}=Z(l?l==null?void 0:l.course:i==null?void 0:i.course),v=g==null?void 0:g.find(t=>t._id===(l==null?void 0:l._id)),k=(a==null?void 0:a.role)==="trainee"?i==null?void 0:i.dtr:v==null?void 0:v.dtr,y=k==null?void 0:k.filter(t=>{var d;return(d=t.date)==null?void 0:d.toLowerCase().includes(r.toLowerCase())}),I=ce.chunk(y,10),K=pe(),D=async()=>{await b({rooms:[a==null?void 0:a.course]}),oe(` ${K==="morning"?"Time in":"Time out"} at exactly ${z().time}`,"success")};ee("DailyTimeRecords");const R=(C=I[o-1])==null?void 0:C.slice().sort((t,d)=>d.date.localeCompare(t.date)).map((t,d)=>{var S,A,L,H,P,M,O,j,E,G,F,Q,$,q;return n("tr",{className:"border-none ",children:[e("td",{className:" md:table-cell lg:table-cell pl-3",children:e(f,{children:e(re,{highlightColor:"cyan",highlight:r,children:z().date===t.date?"Today":t.date})})}),e("td",{className:"hidden md:table-cell lg:table-cell",children:e(h,{children:n(u,{spacing:8,children:[e(N,{size:16,className:"text-yellow-400"}),e("span",{children:(S=t.morning)==null?void 0:S.in})," -"," ",e("span",{children:(A=t.morning)==null?void 0:A.out})]})})}),e("td",{className:"hidden md:table-cell lg:table-cell",children:e(h,{children:n(u,{spacing:8,children:[e(N,{size:16,className:"text-violet-400"}),e("span",{children:(L=t.afternoon)==null?void 0:L.in})," -"," ",e("span",{children:(H=t.afternoon)==null?void 0:H.out})]})})}),e("td",{className:"py-2  md:table-cell lg:table-cell ",children:t.status==="recorded"?n(h,{align:"center",gap:6,className:"bg-gray-50 px-2 py-1 rounded w-max",children:[e("div",{className:"w-2 h-2 bg-green-300"}),e(f,{fw:"bold",className:"text-[10px] text-green-300 uppercase",children:t.status})]}):n(h,{align:"center",gap:6,className:"bg-gray-50 px-2 py-1 rounded w-max",children:[e(me,{processing:!0,size:7,radius:0,color:((P=t.morning)==null?void 0:P.in)!==""&&((M=t.morning)==null?void 0:M.out)===""?"yellow":"indigo",className:"opacity-70",ml:2,mr:5,mb:1,children:e("span",{})}),e(f,{fw:"bold",className:`text-[10px] uppercase ${((O=t.morning)==null?void 0:O.in)!==""&&((j=t.morning)==null?void 0:j.out)===""?"text-yellow-300":"text-indigo-300"}`,children:t.status})]})}),e("td",{className:"py-2 table-cell  md:hidden lg:hidden ",children:n(c,{shadow:"md",transitionProps:{transition:"rotate-right",duration:150},withArrow:!0,children:[e(c.Target,{children:e(te,{variant:"white",color:"cyan",children:e(ge,{size:19})})}),n(c.Dropdown,{children:[((E=t.morning)==null?void 0:E.in)!==""&&n(p,{children:[e(c.Label,{children:"Morning"}),e(c.Item,{p:0,className:"bg-white hover:bg-white",children:e(_,{px:10,pb:5,spacing:1,children:n(u,{spacing:8,className:"text-xs",children:[e(N,{size:16,className:"text-yellow-400"}),e("span",{children:(G=t.morning)==null?void 0:G.in})," -"," ",e("span",{children:(F=t.morning)==null?void 0:F.out})]})})}),e(c.Divider,{})]}),((Q=t.afternoon)==null?void 0:Q.in)!==""&&n(p,{children:[e(c.Label,{children:"Afternoon"}),e(c.Item,{p:0,className:"bg-white hover:bg-white",children:e(_,{px:10,pb:5,spacing:1,children:n(u,{spacing:8,className:"text-xs",children:[e(N,{size:16,className:"text-violet-400"}),e("span",{children:($=t.afternoon)==null?void 0:$.in})," -"," ",e("span",{children:(q=t.afternoon)==null?void 0:q.out})]})})})]})]})]})})]},d)}),{isTimeIn:U,isTimeOut:W,today:w}=ue(i==null?void 0:i.dtr);return n("div",{className:"pb-3",children:[n(h,{justify:"space-between",align:"center",pb:6,children:[e(ne,{}),(a==null?void 0:a.role)==="trainee"&&e(p,{children:!w||(w==null?void 0:w.status)!=="recorded"?n(p,{children:[U?e(J,{color:"yellow",size:"xs",onClick:D,loading:m,children:"Time in"}):"",W?e(J,{color:"indigo",size:"xs",onClick:D,loading:m,children:"Time out"}):""]}):""})]}),n(ae,{className:"bg-opacity-60 rounded-md shadow-md h-[calc(100vh-160px)] ",children:[e("div",{className:"h-[95%]",children:n("table",{className:"border-collapse border-none w-full",children:[e("thead",{children:n("tr",{children:[e("th",{scope:"col",className:" md:px-3 lg:px-3 pl-3 py-3 text-left text-[12px] font-[600] text-gray-400 tracking-wider  bg-gray-100 shadow-sm rounded-tl-md",children:"Date"}),e("th",{scope:"col",className:"hidden  md:table-cell lg:table-cell rounded-tl-md md:rounded-none lg:rounded-none py-3  md:pr-3 lg:pr-3 text-left text-[12px] font-[600] text-gray-400 tracking-wider  bg-gray-100 shadow-sm",children:"Morning"}),e("th",{scope:"col",className:"hidden md:table-cell lg:table-cell py-3 text-left text-[12px] font-[600] text-gray-400 tracking-wider bg-gray-100 shadow-sm rounded-tr-md lg:rounded-none",children:"Afternoon"}),e("th",{scope:"col",className:"  md:table-cell lg:table-cell  py-3 text-left text-[11px] font-[600] text-gray-400   tracking-wider  bg-gray-100 shadow-sm lg:rounded-tr-md rounded-none",children:"Status"}),e("th",{scope:"col",className:"  md:hidden lg:hidden table-cell  py-3 text-left text-[11px] font-[600] text-gray-400   tracking-wider  bg-gray-100 shadow-sm rounded-tr-md"})]})}),(y==null?void 0:y.length)===0?e(p,{children:e(le,{text:"No records found"})}):e("tbody",{className:"text-sm text-gray-600",children:R})]})}),n(h,{justify:"space-between",children:[e(se,{rightSection:r?e(ie,{onClick:()=>x(""),size:14,className:"hover:cursor-pointer text-gray-500 hover:text-gray-800 transition-all"}):e(de,{size:14,className:"text-gray-500"}),size:"xs",placeholder:"Search date, ex. May 9",value:r,onChange:t=>x(t.currentTarget.value)}),n(u,{children:[n(f,{c:"dimmed",fz:"xs",className:"hidden lg:flex md:flex",children:["Page ",o," of ",I.length]}),e(he,{total:I.length,value:o,onChange:s,size:"xs",color:"teal"})]})]})]})]})};export{fe as default};
