import{l as U,r as V,n as W,m as X,o as Y,H as Z,x as ee,J as N,p as te,i as n,j as e,T as a,q as S,K as d,A as ne,F as u,S as _,G as p,L as ae,P as k,N as re,C as le}from"./index-24d6de80.js";import{l as se,E as ce,P as de}from"./EmptyState-e33e9fa9.js";import{I as ie}from"./IconDots-63fcfa75.js";import{I as q}from"./IconClock-d6a0d0e1.js";const ge=({profile:i})=>{var T,z,v,A,D,E;const{user:o}=U(t=>t.auth),[b,B]=V.useState(1),[H,{close:J,open:K}]=W(!1),{data:f}=X(),O=new Date,{data:h}=Y(),{data:y}=Z(i==null?void 0:i.course,{skip:(o==null?void 0:o.role)==="trainee"}),m=y==null?void 0:y.find(t=>t._id===(i==null?void 0:i._id)),w=se.chunk((o==null?void 0:o.role)==="trainee"?(T=h==null?void 0:h.timesheet)==null?void 0:T.slice().sort((t,c)=>c.date.localeCompare(t.date)):(z=m==null?void 0:m.timesheet)==null?void 0:z.slice().sort((t,c)=>c.date.localeCompare(t.date)),10);ee("Timesheet");const R=(v=w[b-1])==null?void 0:v.map((t,c)=>{var P,$,C,j,G,L,I,M,F,Q;const g=N(t.date),x={status:t.status,morning:t.morning,afternoon:t.afternoon},r=te(x);return n("tr",{children:[e("td",{className:"md:table-cell lg:table-cell pl-3",children:e(a,{children:g.date===O.toDateString()?"Today":g.date})}),e("td",{className:"md:table-cell lg:table-cell",children:e(a,{children:t.task})}),e("td",{className:"hidden md:table-cell lg:table-cell",children:e(a,{children:t.ticket})}),e("td",{className:"py-2 hidden md:table-cell lg:table-cell ",children:n(a,{children:[r.totalSpent.hours===1?r.totalSpent.hours+"hr":r.totalSpent.hours>1?r.totalSpent.hours+"hrs":r.totalSpent.hours===0&&"",r.totalSpent.minutes===1?r.totalSpent.minutes+"min":r.totalSpent.minutes>1?r.totalSpent.minutes+"mins":r.totalSpent.minutes===0&&""]})}),e("td",{className:"py-2 hidden md:table-cell lg:table-cell ",children:t.status==="recorded"?n(S,{align:"center",gap:8,children:[e("div",{className:"bg-green-300 p-1"}),e(a,{fz:"sm",className:"text-gray-400  text-[10px] uppercase font-semibold ",children:"recorded"})]}):e(a,{fz:"xs",fw:"bold",children:t.status})}),e("td",{className:"dark:text-gray-400 md:table-cell lg:table-cell",children:n(d,{shadow:"md",transitionProps:{transition:"rotate-right",duration:150},withArrow:!0,children:[e(d.Target,{children:e(ne,{variant:"white",color:"cyan",children:e(ie,{size:19})})}),n(d.Dropdown,{children:[((P=t.morning)==null?void 0:P.start)!==""&&n(u,{children:[e(d.Label,{children:"Morning"}),e(d.Item,{p:0,className:"bg-white hover:bg-white",children:n(_,{px:10,pb:5,spacing:1,children:[n(p,{spacing:8,children:[e(q,{size:16,className:"text-yellow-300"}),n(a,{c:"dark",fz:"xs",children:[e("span",{children:($=t.morning)==null?void 0:$.start})," -"," ",e("span",{className:((C=t.morning)==null?void 0:C.end)===""?"text-gray-500":"",children:((j=t.morning)==null?void 0:j.end)===""?"recording":(G=t.morning)==null?void 0:G.end})]})]}),n(a,{c:"dark",fz:"xs",children:["Spent:"," ",r.morning.spent.hours!==0&&`${r.morning.spent.hours}hr${r.morning.spent.hours!==1?"s":""}`,r.morning.spent.minutes!==0&&`${r.morning.spent.minutes}min${r.morning.spent.minutes!==1?"s":""}`]})]})}),e(d.Divider,{})]}),((L=t.afternoon)==null?void 0:L.start)!==""&&n(u,{children:[e(d.Label,{children:"Afternoon"}),e(d.Item,{p:0,className:"bg-white hover:bg-white",children:n(_,{px:10,pb:5,spacing:1,children:[n(p,{spacing:8,children:[e(q,{size:16,className:"text-violet-400"}),n(a,{c:"dark",fz:"xs",children:[e("span",{children:(I=t.afternoon)==null?void 0:I.start})," -"," ",e("span",{className:((M=t.afternoon)==null?void 0:M.end)===""?"text-gray-500":"",children:((F=t.afternoon)==null?void 0:F.end)===""?"recording":(Q=t.afternoon)==null?void 0:Q.end})]})]}),n(a,{c:"dark",fz:"xs",children:["Spent:"," ",r.afternoon.spent.hours!==0&&`${r.afternoon.spent.hours}hr${r.afternoon.spent.hours!==1?"s":""}`,r.afternoon.spent.minutes!==0&&`${r.afternoon.spent.minutes}min${r.afternoon.spent.minutes!==1?"s":""}`]})]})})]})]})]})})]},c)}),s=f==null?void 0:f.filter(t=>t.status==="inprogress"),l=s==null?void 0:s.reduce((t,c)=>{var g,x;return((g=c.timeline)==null?void 0:g.startedAt)<((x=t==null?void 0:t.timeline)==null?void 0:x.startedAt)?c:t},s==null?void 0:s[0]);return n(u,{children:[n(S,{justify:"space-between",pb:6,align:"center",children:[e(ae,{}),e(p,{className:"",fz:12,children:e(p,{spacing:8,c:"dark",children:(s==null?void 0:s.length)!==0&&n(u,{children:[e(a,{fw:"bold",children:"Current task:"}),n(k,{position:"bottom",withArrow:!0,shadow:"md",opened:H,children:[e(k.Target,{children:e(a,{c:"dimmed",className:"cursor-pointer hover:text-gray-400 transition-all",onMouseEnter:K,onMouseLeave:J,children:l==null?void 0:l.ticketno})}),e(k.Dropdown,{sx:{pointerEvents:"none"},children:n(re,{component:"div",children:[e(a,{fw:"bold",c:"dark",fz:"sm",pb:5,children:l==null?void 0:l.taskname}),n(p,{className:"text-gray-500",fz:"xs",spacing:8,children:[e(a,{children:"Added:"}),e(a,{children:N(l==null?void 0:l.createdAt).date})]}),n(p,{className:"text-gray-500",fz:"xs",spacing:8,children:[e(a,{children:"Started:"}),e(a,{children:N((A=l==null?void 0:l.timeline)==null?void 0:A.startedAt).date})]})]})})]})]})})})]}),n(le,{className:"bg-opacity-60 rounded-md shadow-md h-[calc(100vh-160px)]",children:[e("div",{className:"h-[96%]",children:n("table",{className:"border-collapse border-none w-full",children:[e("thead",{children:n("tr",{children:[e("th",{scope:"col",className:"md:px-3 lg:px-3 pl-3 py-3 text-left text-[11px] font-[600] text-gray-400   tracking-wider  bg-gray-100 shadow-sm rounded-tl-md",children:e(a,{children:"Date"})}),e("th",{scope:"col",className:" md:rounded-none lg:rounded-none py-3 md:pr-3 lg:pr-3 text-left text-[11px] font-[600] text-gray-400   tracking-wider  bg-gray-100 shadow-sm",children:e(a,{children:"Task Name"})}),e("th",{scope:"col",className:"hidden md:table-cell lg:table-cell  py-3 text-left text-[11px] font-[600] text-gray-400   tracking-wider bg-gray-100 shadow-sm",children:e(a,{children:"Ticket No."})}),e("th",{scope:"col",className:"hidden md:table-cell lg:table-cell py-3 text-left text-[11px] font-[600] text-gray-400   tracking-wider bg-gray-100 shadow-sm",children:e(a,{children:"Total Spent"})}),e("th",{scope:"col",className:" hidden md:table-cell lg:table-cell py-3 text-left text-[11px] font-[600] text-gray-400   tracking-wider bg-gray-100 shadow-sm",children:e(a,{children:"Status"})}),e("th",{scope:"col",className:" py-3 text-left text-[11px] font-[600] text-gray-400   tracking-wider  bg-gray-100 shadow-sm rounded-tr-md",children:e(a,{children:"Expand"})})]})}),((D=h==null?void 0:h.timesheet)==null?void 0:D.length)===0||((E=m==null?void 0:m.timesheet)==null?void 0:E.length)===0?n(u,{children:[e(ce,{text:"No records found"}),";"]}):e("tbody",{className:"text-sm text-gray-600",children:R})]})}),n(S,{justify:"space-between",children:[n(a,{c:"dimmed",fz:"xs",children:["Page ",b," of ",w.length]}),e(de,{total:w.length,value:b,onChange:B,size:"xs",color:"teal",withEdges:!0})]})]})]})};export{ge as default};
