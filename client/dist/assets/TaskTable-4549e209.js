import{r as b,i as M,D as E,a4 as G,n as e,M as L,m as s,G as f,T as n,J as $,F as P,o as h,t as k,B as m,a5 as q,X as J,j as R,a6 as H,k as O,E as U,a3 as V,H as r,A as X,a7 as C,C as K}from"./index-a4716bfd.js";import{l as W,P as Y}from"./lodash-44113222.js";import{I as D,S as Z}from"./IconInfoCircle-4fb0ab84.js";import{I as ee}from"./IconDots-1067b901.js";const le=({task:d,assign:g,toggle:u})=>{const[p,w]=b.useState(""),{user:t}=M(i=>i.auth),{data:a}=E(t==null?void 0:t.course),[o,{isLoading:y}]=G(),N=async i=>{q(t==null?void 0:t.course,t==null?void 0:t.role),w(i);const x={_id:d._id,name:i,course:t==null?void 0:t.course};await o({task:x,rooms:[t==null?void 0:t.course]}),u()};return e(L,{size:"md",opened:g,onClose:u,title:s(f,{spacing:8,children:[e(n,{fz:"sm",className:"text-gray-500 font-semibold",children:"Task:"}),e(n,{fz:"sm",c:"dimmed",children:d.taskname})]}),centered:!0,children:e("div",{className:"space-y-2",children:e($,{spacing:9,p:8,children:s(P,{children:[e(n,{fz:"sm",fw:"bold",children:"Members"}),a==null?void 0:a.map(i=>s(h,{justify:"space-between",align:"center",children:[s(f,{spacing:10,children:[e(k,{src:i.picture,width:35,radius:"xl",imageProps:{referrerPolicy:"no-referrer"}}),s("div",{className:"-space-y-[2px]",children:[e(n,{size:"sm",children:i.name}),e(n,{c:"dimmed",size:"xs",children:i.email})]})]}),e(m,{size:"xs",variant:"white",onClick:()=>N(i.name),loading:y&&p===i.name,children:"Assign"})]}))]})})})})},ie=({trainee:d,view:g,update:u,setViewId:p})=>{var I;const w=J(),{pathname:t}=w,{user:a}=M(l=>l.auth),{data:o}=R(),[y,{isLoading:N}]=H(),[i,{toggle:x}]=O(),[A,S]=b.useState(1),[F,j]=b.useState({}),[v,B]=b.useState(""),c=o==null?void 0:o.filter(l=>v?l.status===v:d?d.name===l.assign:l),Q=async l=>{await y({_id:l,rooms:[a==null?void 0:a.course]})},T=W.chunk(c,10),_=(I=T[A-1])==null?void 0:I.map(l=>{const z=U(l==null?void 0:l.createdAt);return s("tr",{children:[e("td",{className:" md:table-cell lg:table-cell pl-3 pt-2",children:s(n,{className:"font-semibold",children:[e("span",{className:"hidden md:flex lg:flex",children:`${z.date} at ${z.time}`}),e("span",{className:"flex md:hidden lg:hidden",children:z.date})]})}),e("td",{className:"hidden md:table-cell lg:table-cell  pt-2",children:e(n,{className:"font-semibold",children:l.taskname})}),e("td",{className:"hidden md:table-cell lg:table-cell  pt-2",children:e(n,{className:"font-semibold",children:l.ticketno})}),t.includes("profile")?"":e("td",{className:"hidden md:table-cell lg:table-cell  pt-2",children:l.assign?e(n,{className:"font-semibold",children:l.assign}):e(V,{color:"teal",size:"md",variant:"dot",className:"text-gray-500",children:"Available Task"})}),e("td",{className:" md:table-cell lg:table-cell  pt-2",children:s(h,{className:"rounded bg-gray-50 max-w-max px-2 py-1 gap-2",align:"center",children:[e("div",{children:e("div",{className:`p-1 ${l.status==="new"?"bg-indigo-300":l.status==="inprogress"?"bg-violet-400":l.status==="completed"?"bg-green-300":l.status==="forqa"?"bg-yellow-300":"bg-red-300"}`})}),e(n,{fw:"bold",className:`text-[11px] ${l.status==="new"?"text-indigo-300":l.status==="inprogress"?"text-violet-400":l.status==="completed"?"text-green-300":l.status==="forqa"?"text-yellow-300":"text-red-300"}`,children:l.status})]})}),e("td",{className:" md:table-cell lg:table-cell  pt-2",children:(a==null?void 0:a.role)==="supervisor"||(a==null?void 0:a.role)==="admin"?e(m,{onClick:()=>{g(),p(l._id)},leftIcon:e(D,{size:16,className:"hidden md:flex lg:flex"}),variant:"white",color:"cyan",size:"xs",children:"View"}):s(r,{shadow:"md",transitionProps:{transition:"rotate-right",duration:150},closeOnItemClick:!0,withArrow:!0,children:[e(r.Target,{children:e(X,{variant:"white",color:"cyan",children:e(ee,{size:19})})}),s(r.Dropdown,{className:"flex row-a",children:[e(r.Label,{children:"Manage task"}),s(h,{direction:"column",align:"start",children:[e(r.Item,{p:0,className:"bg-white hover:bg-white",children:e(m,{onClick:()=>{g(),p(l._id)},leftIcon:e(D,{size:16}),variant:"white",color:"dark",size:"xs",children:"View"})}),l.status==="new"&&e(r.Item,{p:0,className:"bg-white hover:bg-white",children:(a==null?void 0:a.role)==="Task manager"||(a==null?void 0:a.role)==="QA Personnel"||t.includes("profile")?e(m,{onClick:()=>{j(l),x()},leftIcon:e(C,{size:16}),variant:"white",color:l.assign?"indigo":"cyan",size:"xs",children:l.assign?"Reassign":"Assign"}):""}),(a==null?void 0:a.role)!=="QA Personnel"&&(l==null?void 0:l.status)==="new"&&e(m,{leftIcon:e(C,{size:16}),variant:"white",size:"xs",color:"red",onClick:()=>Q(l._id),loading:N,children:"Delete"})]})]})]})})]})});return s(P,{children:[s(K,{className:"bg-opacity-60 rounded-md shadow-md h-[calc(100vh-200px)] mt-4",children:[e("div",{className:"h-[95%] overflow-",children:s("table",{className:"border-collapse border-none w-full",children:[e("thead",{children:s("tr",{children:[e("th",{scope:"col",className:"md:px-3 lg:px-3 pl-3 py-3 text-left text-[9px] font-[600] text-gray-400   tracking-wider  bg-gray-100 shadow-sm rounded-tl-md",children:e(n,{children:"Date Added"})}),e("th",{scope:"col",className:"hidden md:table-cell lg:table-cell  py-3 md:pr-3 lg:pr-3 text-left text-[9px] font-[600] text-gray-400   tracking-wider  bg-gray-100 shadow-sm",children:e(n,{children:"Task Name"})}),e("th",{scope:"col",className:"hidden md:table-cell lg:table-cell py-3 text-left text-[9px] font-[600] text-gray-400   tracking-wider bg-gray-100 shadow-sm",children:e(n,{children:"Ticket No."})}),!t.includes("profile")&&e("th",{scope:"col",className:"hidden  md:table-cell lg:table-cell py-3 text-left text-[9px] font-[600] text-gray-400   tracking-wider bg-gray-100 shadow-sm",children:e(n,{children:"Assigned to"})}),e("th",{scope:"col",className:"  md:table-cell lg:table-cell py-3 text-left text-[9px] font-[600] text-gray-400   tracking-wider bg-gray-100 shadow-sm",children:e(n,{children:"Status"})}),e("th",{scope:"col",className:"md:px-3 lg:px-3 pl-3 py-3 text-left text-[9px] font-[600] text-gray-400   tracking-wider  bg-gray-100 shadow-sm rounded-tr-md",children:e(n,{children:"Action"})})]})}),e("tbody",{className:"text-xs text-gray-600",children:_})]})}),s(h,{justify:"space-between",children:[s(f,{align:"center",children:[e(Z,{size:"xs",value:v,onChange:B,w:150,placeholder:"Filter",data:[{value:"",label:"All tasks"},{value:"new",label:"New"},{value:"inprogress",label:"In-Progress"},{value:"forqa",label:"For-QA"},{value:"failed",label:"Failed"},{value:"completed",label:"Completed"}]}),e(h,{children:s(f,{spacing:3,children:[e(n,{fz:"xs",className:"uppercase font-semibold text-gray-700",children:"Total:"}),s(n,{fz:"xs",children:[c==null?void 0:c.length," task",(c==null?void 0:c.length)>=2&&"s"]})]})})]}),e(Y,{total:T.length,value:A,onChange:S,size:"xs",color:"cyan",withEdges:!0})]})]}),e(le,{task:F,assign:i,toggle:x})]})};export{ie as default};
